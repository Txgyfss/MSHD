{"ast":null,"code":"import request from \"@/utils/request\";\nexport default {\n  data() {\n    return {\n      colWidth: 150,\n      tableData: [],\n      pageNum: 1,\n      dialogVisible: false,\n      searchQuery: \"\",\n      form: {},\n      total: 0\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    // 加载表格数据\n    load() {\n      const params = {\n        pageNum: this.pageNum,\n        pageSize: 5,\n        query: this.searchQuery\n      };\n      request.get(\"/all\", {\n        params\n      }).then(res => {\n        if (res.code === \"0\") {\n          this.tableData = res.data;\n          this.total = res.data.length;\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    // 编辑数据\n    edit(row) {\n      this.form = {\n        ...row\n      }; // 将行数据赋值给表单\n      this.dialogVisible = true;\n    },\n    // 保存数据\n    save() {\n      request.post(\"http://localhost:8080/update\", this.form).then(res => {\n        if (res.code === \"0\") {\n          this.$notify.success(\"保存成功\");\n          this.dialogVisible = false;\n          this.load(); // 刷新表格数据\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    // 删除数据\n    del(id) {\n      if (!id) {\n        this.$notify.error(\"ID不能为空\");\n        return;\n      }\n      request.delete(`http://localhost:8080/delete/${id}`).then(res => {\n        if (res.code === \"0\") {\n          this.$notify.success(\"删除成功\");\n          this.load(); // 刷新表格数据\n        } else {\n          this.$notify.error(res.msg);\n        }\n      }).catch(err => {\n        console.error(\"删除失败：\", err);\n        this.$notify.error(\"删除操作失败，请稍后重试\");\n      });\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    }\n  }\n};","map":{"version":3,"names":["request","data","colWidth","tableData","pageNum","dialogVisible","searchQuery","form","total","mounted","load","methods","params","pageSize","query","get","then","res","code","length","$notify","error","msg","edit","row","save","post","success","del","id","delete","catch","err","console","handleCurrentChange"],"sources":["src/views/manager/Advertising.vue"],"sourcesContent":["<template>\n  <div>\n    <div>\n      <div class=\"main-body-content\">\n        <div class=\"main-body-search\">\n          <div class=\"main-body-header\">灾情数据表格</div>\n          <el-input size=\"small\" class=\"main-input\" placeholder=\"请输入查询条件\" v-model=\"searchQuery\"></el-input>\n          <el-button size=\"small\" type=\"info\" @click=\"load\">查询</el-button>\n        </div>\n        <div class=\"main-table-box\">\n          <el-table style=\"width: 100%\" :data=\"tableData\" size=\"small\" stripe header-cell-class-name=\"tableHeaderClass\">\n            <el-table-column label=\"灾情码\" prop=\"disastercode\"></el-table-column>\n            <el-table-column label=\"省份\" prop=\"province\"></el-table-column>\n            <el-table-column label=\"城市\" prop=\"city\"></el-table-column>\n            <el-table-column label=\"区/县\" prop=\"country\"></el-table-column>\n            <el-table-column label=\"乡镇\" prop=\"town\"></el-table-column>\n            <el-table-column label=\"村\" prop=\"village\"></el-table-column>\n            <el-table-column label=\"日期\" prop=\"date\"></el-table-column>\n            <el-table-column label=\"数据来源\" prop=\"sourceCategory\"></el-table-column>\n            <el-table-column label=\"灾情类型\" prop=\"disasterMajorCategory\"></el-table-column>\n            <el-table-column label=\"操作\" :width=\"150\" fixed=\"right\">\n              <template v-slot=\"scope\">\n                <el-button size=\"small\" type=\"primary\" @click=\"edit(scope.row)\">编辑</el-button>\n                <el-popconfirm title=\"确定删除吗？\" @confirm=\"del(scope.row.id)\">\n                  <el-button size=\"small\" type=\"danger\" slot=\"reference\">删除</el-button>\n                </el-popconfirm>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n        <div style=\"margin: 20px 0\">\n          <el-pagination background @current-change=\"handleCurrentChange\" :current-page=\"pageNum\" :page-size=\"5\"\n            layout=\"total, prev, pager, next\" :total=\"total\"></el-pagination>\n        </div>\n      </div>\n    </div>\n    <el-dialog title=\"编辑灾情信息\" :visible.sync=\"dialogVisible\" width=\"40%\">\n      <el-form :model=\"form\" label-position=\"right\" label-width=\"100px\" style=\"padding-right: 40px\">\n        <el-form-item label=\"ID\">\n          <el-input size=\"small\" v-model=\"form.id\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"灾情码\">\n          <el-input size=\"small\" v-model=\"form.disastercode\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"省份\">\n          <el-input size=\"small\" v-model=\"form.province\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"城市\">\n          <el-input size=\"small\" v-model=\"form.city\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"区/县\">\n          <el-input size=\"small\" v-model=\"form.country\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"乡镇\">\n          <el-input size=\"small\" v-model=\"form.town\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"村\">\n          <el-input size=\"small\" v-model=\"form.village\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"日期\">\n          <el-input size=\"small\" v-model=\"form.date\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"数据来源\">\n          <el-input size=\"small\" v-model=\"form.sourceCategory\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"详情\">\n          <el-input size=\"small\" v-model=\"form.detail\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button size=\"small\" @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button size=\"small\" type=\"primary\" @click=\"save\">保 存</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\n\nexport default {\n  data() {\n    return {\n      colWidth: 150,\n      tableData: [],\n      pageNum: 1,\n      dialogVisible: false,\n      searchQuery: \"\",\n      form: {},\n      total: 0,\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    // 加载表格数据\n    load() {\n      const params = {\n        pageNum: this.pageNum,\n        pageSize: 5,\n        query: this.searchQuery,\n      };\n      request.get(\"/all\", { params }).then((res) => {\n        if (res.code === \"0\") {\n          this.tableData = res.data;\n          this.total = res.data.length;\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    // 编辑数据\n    edit(row) {\n      this.form = { ...row }; // 将行数据赋值给表单\n      this.dialogVisible = true;\n    },\n    // 保存数据\n    save() {\n      request.post(\"http://localhost:8080/update\", this.form).then((res) => {\n        if (res.code === \"0\") {\n          this.$notify.success(\"保存成功\");\n          this.dialogVisible = false;\n          this.load(); // 刷新表格数据\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    // 删除数据\n    del(id) {\n      if (!id) {\n        this.$notify.error(\"ID不能为空\");\n        return;\n      }\n\n      request\n        .delete(`http://localhost:8080/delete/${id}`)\n        .then((res) => {\n          if (res.code === \"0\") {\n            this.$notify.success(\"删除成功\");\n            this.load(); // 刷新表格数据\n          } else {\n            this.$notify.error(res.msg);\n          }\n        })\n        .catch((err) => {\n          console.error(\"删除失败：\", err);\n          this.$notify.error(\"删除操作失败，请稍后重试\");\n        });\n    },\n\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    },\n  },\n};\n</script>\n"],"mappings":"AA8EA,OAAAA,OAAA;AAEA;EACAC,KAAA;IACA;MACAC,QAAA;MACAC,SAAA;MACAC,OAAA;MACAC,aAAA;MACAC,WAAA;MACAC,IAAA;MACAC,KAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACA;IACAD,KAAA;MACA,MAAAE,MAAA;QACAR,OAAA,OAAAA,OAAA;QACAS,QAAA;QACAC,KAAA,OAAAR;MACA;MACAN,OAAA,CAAAe,GAAA;QAAAH;MAAA,GAAAI,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAf,SAAA,GAAAc,GAAA,CAAAhB,IAAA;UACA,KAAAO,KAAA,GAAAS,GAAA,CAAAhB,IAAA,CAAAkB,MAAA;QACA;UACA,KAAAC,OAAA,CAAAC,KAAA,CAAAJ,GAAA,CAAAK,GAAA;QACA;MACA;IACA;IACA;IACAC,KAAAC,GAAA;MACA,KAAAjB,IAAA;QAAA,GAAAiB;MAAA;MACA,KAAAnB,aAAA;IACA;IACA;IACAoB,KAAA;MACAzB,OAAA,CAAA0B,IAAA,sCAAAnB,IAAA,EAAAS,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAE,OAAA,CAAAO,OAAA;UACA,KAAAtB,aAAA;UACA,KAAAK,IAAA;QACA;UACA,KAAAU,OAAA,CAAAC,KAAA,CAAAJ,GAAA,CAAAK,GAAA;QACA;MACA;IACA;IACA;IACAM,IAAAC,EAAA;MACA,KAAAA,EAAA;QACA,KAAAT,OAAA,CAAAC,KAAA;QACA;MACA;MAEArB,OAAA,CACA8B,MAAA,iCAAAD,EAAA,IACAb,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAE,OAAA,CAAAO,OAAA;UACA,KAAAjB,IAAA;QACA;UACA,KAAAU,OAAA,CAAAC,KAAA,CAAAJ,GAAA,CAAAK,GAAA;QACA;MACA,GACAS,KAAA,CAAAC,GAAA;QACAC,OAAA,CAAAZ,KAAA,UAAAW,GAAA;QACA,KAAAZ,OAAA,CAAAC,KAAA;MACA;IACA;IAEAa,oBAAA9B,OAAA;MACA,KAAAA,OAAA,GAAAA,OAAA;MACA,KAAAM,IAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}